I gathered on this repository all the code I developped during my PhD, entitled:

# Identification of neurodevelopmental variability in brain anatomical images

> **Abstract:** *Even though most mental disorders start during adolescence, the neurodevelopmental hypothesis of mental disorders suggests that there are underlying abnormalities present before the onset of the first symptoms. Specifically, the double-hit model of schizophrenia posits that the interactions of two hits, one during the in-utero or perinatal periods and one during later brain maturation stages, lead to the onset of the disorder. Depending on the contribution of each hit, patients may follow distinct pathways to develop the disorder. Since brain anatomy is an imprint of the subject's neurodevelopmental background (genetic and early deviations in brain development) and environmental influence (later experiences such as stress exposure), these two hits may leave identifiable traces in brain anatomy. This work aims to disentangle neurodevelopmental and environmental variability in brain anatomy. By doing this, we expected to distinguish abnormal neurodevelopmental trajectories towards the disorder from later-onset abnormal brain maturation development that would be detrimental consequences of interaction with the environment.
In this work, we developed an encoder to extract relevant information from brain-folding shapes, which are promising candidates for capturing the neurodevelopmental contribution to brain anatomy. Indeed, brain folding shapes are established shortly after birth and remain stable across life; that is why they are considered as trait features. To investigate brain folding, we processed structural Magnetic Resonance Images (MRI) to extract the skeleton, a 3D image representing brain folds. We trained Machine-Learning (ML) models from these skeletons and evaluated the learned representations on case-control classifications of three mental disorders (autism spectrum disorders, bipolar disorders and schizophrenia). We implemented ML strategies to tackle the high inter-individual heterogeneity of brain folding shapes through transfer learning and regional approaches. We also implemented an explainability method to gain insights into the model's decision-making processes. Our results demonstrated that skeletons capture enough information to accurately predict the three diagnostic categories, supporting the hypothesis that patients may show brain deviations before the onset of the disorder.
We then aimed to advance toward a multimodal approach that disentangles information within brain anatomy into neurodevelopmental and environmental components. To achieve this, we aimed to combine skeletons, which capture neurodevelopment information, with other brain features, which capture a combination of neurodevelopmental and environmental information. From these two brain features, we aimed to develop ML model that can isolate the shared contents of the two brain features and the specificities of each brain feature. To benchmark the developed model, we built synthetic datasets composed of two modalities that include shared and unique content. Despite mitigated results on synthetic datasets, we applied a proposed model with two brain features: skeletons, which capture neurodevelopmental information, and Voxel Based Morphometry (VBM) images, which capture a combination of neurodevelopmental and environmental information. To assess the model's success in disentangling neurodevelopmental information, we sought to predict neurological soft signs scores that quantify the neurodevelopmental load of subjects.*


## Repository organization

* ```make_dataset```: scripts for the creation of the clinical and general population datasets. For each dataset, a numpy array is created with the skeleton images of the subjects along with a tsv file with the meta-data. I developped the scripts in particular for the morphologist preprocessing (skeletons).
* ```brain_folding_shape_encoder```: developping an encoder able to extract relevant representations of brain folding (chapter 2).
* ```brain_image_disentangling```: developping models to isolate the neurodevelopmental contribution to brain anatomy (chapter 3).
